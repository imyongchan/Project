{% extends "base.html" %}
{% load static %}

{% block title %}산재콕 | 메인{% endblock %}

{% block script1 %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
{% endblock %}


{% block contents %}

<section class="hero">
    <div class="hero-overlay">
        <div class="hero-content">
            <h1>산업재해 정보를 한눈에 콕콕! 짚어드립니다</h1>
            <p>산재 예방과 정보 제공의 최전선</p>
            <a href="{% url 'Main:service' %}" class="hero-btn">VIEW SERVICES</a>
        </div>
    </div>
</section>

<section class="quick-section">
  <div class="quick-container">
    <div class="quick-header">
      <p class="quick-subtitle">산재콕 서비스</p>
      <h2>한 번에 콕! 필요한 메뉴로 이동</h2>
      <p class="quick-desc">산재 뉴스, 통계, 지도검색, 안전자료실까지 빠르게 이동하세요.</p>
    </div>

    <div class="quick-grid quick-grid-5">
      <!-- 산재뉴스 -->
      <a class="quick-card" href="{% url 'News:news_list' %}">
        <div class="quick-icon bg-orange"><i class="fa-solid fa-newspaper"></i></div>
        <div class="quick-body">
          <h3>산재뉴스</h3>
          <p>최신 산업재해/안전 관련 뉴스를 모아보기</p>
        </div>
        <span class="quick-arrow"><i class="fa-solid fa-arrow-right"></i></span>
      </a>

      <!-- 산재통계 -->
      <a class="quick-card" href="{% url 'Stats:stats_home' %}">
        <div class="quick-icon bg-navy"><i class="fa-solid fa-chart-column"></i></div>
        <div class="quick-body">
          <h3>산재통계</h3>
          <p>업종·성별·연령 기반 맞춤 통계와 위험도</p>
        </div>
        <span class="quick-arrow"><i class="fa-solid fa-arrow-right"></i></span>
      </a>

      <!-- 주변 산재(지정의료기관) 찾기 -->
      <a class="quick-card" href="{% url 'Search:search_page' %}">
        <div class="quick-icon bg-green"><i class="fa-solid fa-location-crosshairs"></i></div>
        <div class="quick-body">
          <h3>주변 산재찾기</h3>
          <p>내 위치 기준 산재 지정의료기관 빠르게 찾기</p>
        </div>
        <span class="quick-arrow"><i class="fa-solid fa-arrow-right"></i></span>
      </a>

      <!-- 주변 병원 찾기 -->
      <a class="quick-card" href="{% url 'Hospital:hospital_search' %}">
        <div class="quick-icon bg-gray"><i class="fa-solid fa-hospital"></i></div>
        <div class="quick-body">
          <h3>주변 병원찾기</h3>
          <p>응급/일반 병원을 지도에서 확인하고 길찾기</p>
        </div>
        <span class="quick-arrow"><i class="fa-solid fa-arrow-right"></i></span>
      </a>

      <!-- 안전자료실 -->
      <a class="quick-card" href="{% url 'Safe:safe_list' %}">
        <div class="quick-icon bg-navy"><i class="fa-solid fa-shield-halved"></i></div>
        <div class="quick-body">
          <h3>안전자료실</h3>
          <p>예방 가이드·체크리스트·교육자료 모음</p>
        </div>
        <span class="quick-arrow"><i class="fa-solid fa-arrow-right"></i></span>
      </a>
    </div>
  </div>
</section>

<div class="clock">
  <div class="clock-date">
      {{ now|date:"Y.m.d" }}
      <span class="day">{{ now|date:"l"|cut:"day" }}</span>
  </div>
  <div class="clock-time">
      <span class="ampm">
          {% if now|date:"A" == "AM" %}오전{% else %}오후{% endif %}
      </span>
      <span class="time">{{ now|date:"h:i" }}</span>
  </div>
</div>

<!-- ================== 메인 콘텐츠 ================== -->
<div class="contents">
  
  
    
    <!-- 왼쪽 : 차트 -->
    <div class="contents1">
        <section class="stats-section">
            <h2>전국 산업재해 통계</h2>

            <div class="chart">
                <div class="chart-buttons">
                  <button class="chart-btn" onclick="showChart('age', this)">연령</button>
                  <button class="chart-btn" onclick="showChart('gender', this)">성별</button>
                  <button class="chart-btn" onclick="showChart('industry', this)">업종</button>
                </div>
            </div>

            <div id="chartArea">
                <p>산출년도: 2021년~2023년</p>
                <canvas id="mainChart"></canvas>
            </div>
        </section>
    </div>

    <!-- 오른쪽 -->
    <div class="contents2">

        <!-- 오른쪽 상단 -->
        
    </div>
</div>

<!-- 통계 더보기 -->
<div class="stats-more">
    <a href="{% url 'Stats:stats_home' %}" class="more-btn1">
        나만의 통계정보 보러가기 ▾
    </a>
</div>







<section class="news-section">
        <div class="news-header">
            <p class="subtitle">산업재해 예방 정보</p>
            <h2>산재콕 뉴스</h2>
        </div>


       
        <div class="news-grid">
            {% for news in list %}
            <article class="news-card">
                <a href="{{ news.n_link }}" target="_blank">
                    <div class="news-thumb">
                    <img src="{% static news.n_image_url %}" alt="뉴스 이미지">
                    </div>
                </a>
                <div class="news-body">
                    <h3 class="news-title">
                    <a href="{{ news.n_link }}" target="_blank">{{ news.n_title }}</a>
                    </h3>
                    <div class="news-meta">
                    <span class="category">{{ news.n_writer }}</span>
                    <span class="date">| {{ news.n_created_at }}</span>
                    </div>
                </div>
            </article>
            {% endfor %}
        </div>

        <!-- 기사 더보기 버튼 -->
        <div class="news-more">
            <a href="{% url 'News:news_list' %}" class="more-btn2">기사 더보기 ▾</a>
        </div>
</section>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script src="{% static 'js/main/main_chart.js' %}"></script>
<script>
    const ageData = {{ age_total|safe }};
    const genderData = {{ gender_total|safe }};
    const industryData = {{ industry_total|safe }};
</script>
{% endblock %}