{% extends "base.html" %}
{% load static %}

{% block title %}산재콕 | 메인{% endblock %}

{% block contents %}

<section class="hero">
    <div class="hero-overlay">
        <div class="hero-content">
            <h1>산재 예방과 정보 제공의 최전선</h1>
            <p>산업재해 정보를 한눈에, 콕콕 짚어드립니다</p>
            <a href="{% url 'Main:service' %}" class="hero-btn">VIEW SERVICES</a>
        </div>
    </div>
</section>

<!-- ================== 메인 콘텐츠 ================== -->
<div class="contents">

    <!-- 왼쪽 : 차트 -->
    <div class="contents1">
        <section class="stats-section">
            <h2>전국 산업재해 통계</h2>

            <div class="chart">
                <div class="chart-buttons">
                    <button onclick="showChart('age')">연령</button>
                    <button onclick="showChart('gender')">성별</button>
                    <button onclick="showChart('industry')">산업</button>
                </div>
            </div>

            <div id="chartArea">
                <p>산출년도: 2021년~2023년</p>
                <canvas id="mainChart"></canvas>
            </div>
        </section>
    </div>

    <!-- 오른쪽 -->
    <div class="contents2">

        <!-- 오른쪽 상단 -->
        <div class="right-top">
            <div class="clock">
                <div class="clock-date">
                    {{ now|date:"Y.m.d" }}
                    <span class="day">{{ now|date:"l"|cut:"day" }}</span>
                </div>
                <div class="clock-time">
                    <span class="ampm">
                        {% if now|date:"A" == "AM" %}오전{% else %}오후{% endif %}
                    </span>
                    <span class="time">{{ now|date:"h:i" }}</span>
                </div>
            </div>

            <!-- poster (GRID 방식) -->
            <div class="poster">
                <div class="poster-wrap">
                    <img src="{% static 'img/poster.png' %}" alt="오늘의 안전 글귀" class="poster-img">
                    <div class="poster-text">
                        <h4>오늘의 안전 글귀</h4>
                        <p>
                            안전한 삶을 만들기 전에 <br>
                            완전한 삶을 이야기 하지 말라
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 오른쪽 하단 -->
        <div class="right-bottom">
            <div class="video-wrap">
                <img src="https://images.stockcake.com/public/8/5/1/8516f929-1cae-4dfe-9f86-020c39b80f5b_large/construction-workers-smiling-stockcake.jpg" alt="">
            </div>
        </div>

    </div>
</div>

<!-- 통계 더보기 -->
<div class="stats-more">
    <a href="{% url 'Stats:stats_home' %}" class="more-btn1">
        나만의 통계정보 보러가기 ▾
    </a>
</div>

<section class="news-section">
        <div class="news-header">
            <p class="subtitle">산업재해 예방 정보</p>
            <h2>산재뉴스</h2>
        </div>


       
        <div class="news-grid">
            {% for news in list %}
            <article class="news-card">
                <a href="{{ news.n_link }}" target="_blank">
                    <div class="news-thumb">
                    <img src="{{ news.n_image_url }}" alt="뉴스 이미지">
                    </div>
                </a>
                <div class="news-body">
                    <h3 class="news-title">
                    <a href="{{ news.n_link }}" target="_blank">{{ news.n_title }}</a>
                    </h3>
                    <div class="news-meta">
                    <span class="category">{{ news.n_writer }}</span>
                    <span class="date">| {{ news.n_created_at }}</span>
                    </div>
                </div>
            </article>
            {% endfor %}
        </div>

        <!-- 기사 더보기 버튼 -->
        <div class="news-more">
            <a href="{% url 'News:news_list' %}" class="more-btn2">기사 더보기 ▾</a>
        </div>
</section>



<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script src="{% static 'js/main/main_chart.js' %}"></script>
<script>
    const ageData = {{ age_total|safe }};
    const genderData = {{ gender_total|safe }};
    const industryData = {{ industry_total|safe }};
</script>
{% endblock %}
