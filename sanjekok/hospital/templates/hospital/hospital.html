{% extends "base.html" %}
{% load static %}

{% block title %}주변 산재지정의료기관 검색{% endblock %}

{% block script1 %}
<link rel="stylesheet" href="{% static 'CSS/hospital/hospital.css' %}">
{% endblock %}

{% block contents %}
<body data-hospital-api-url="{% url 'Hospital:hospital_api' %}">

<h2 class="page-title">주변 산재지정의료기관 검색</h2>

<div class="search-box">

  <!-- 1. 위치 선택 -->
<div class="search-row">
  <label class="search-label">위치선택:</label>

  <button id="btn-home" class="btn-location">집</button>
  <button id="btn-work" class="btn-location">근무지</button>

    <div class="accident-wrapper">
      <div class="dropdown accident-dropdown">
        <button id="btn-accident" type="button" class="btn-location">
          사고지역 ▼
        </button>
        <div id="accidentMenu" class="dropdown-menu">
        </div>
      </div>
    </div>
  </div>

  <p class="search-help">
    선택한 위치를 기준으로 가까운 산재지정의료기관을 찾아드립니다.
  </p>

  <!-- 3. 정렬 기준 선택 -->
  <div class="sort-row">
    <span class="sort-label">구분</span>
    <div class="dropdown sort-dropdown">
      <button id="sortBtn" type="button" class="dropdown-btn">
        거리순 ▼
      </button>
      <div id="sortMenu" class="dropdown-menu">
        <div class="sort-option" data-sort="distance">거리순</div>
        <div class="sort-option" data-sort="rating">평점순</div>
        <div class="sort-option" data-sort="review">리뷰 많은 순</div>
      </div>
    </div>
  </div>
</div>

<!-- 2. 안내 텍스트 영역(이미지 2번 위치) -->
<div class="notice-box">
  <p class="notice-text">
    근로복지공단이 지정한 협의기관으로, 산재치료비를 당사 근로자가 요양급여를 받을 수 있는 병원입니다.
    산재보험 적용을 받으려면 산재지정의료기관을 이용해야 합니다.
  </p>
</div>

<!-- 메시지 영역 -->
<div id="hospital-message" class="hospital-message"></div>

<!-- 2. 병원 리스트 -->
<div class="result-box">
  <h3 class="result-title">주변 산재지정의료기관</h3>
  <ul id="hospital-list" class="hospital-list"></ul>
</div>

<script>
  window.HOSPITAL_CONTEXT = {
    home: "{{ home_address|default:''|escapejs }}",
    work: "{{ work_address|default:''|escapejs }}",
    accidents: [
      {% for a in accidents %}
      {
        id: "{{ a.id }}",
        title: "{{ a.title|escapejs }}",
        address: "{{ a.address|escapejs }}"
      }{% if not forloop.last %},{% endif %}
      {% endfor %}
    ]
  };
</script>
<script src="{% static 'js/hospital/hospital.js' %}"></script>
{% endblock %}
</body>
</html>
